


#-----------------------------------------------------------------------
#Librerias
#----------------------------------------------------------------------
#Libreria grafica
library(ggplot2)
#Libreria test B-P
library(lmtest)


#--------------------------------------------------------------------------
pbi_pc=c(5110,5919,7245,9021,8225,10386,12849,13083,13080,12335,13789,12790,14613,11633,9912,8938)
          

afiliados=c(120,50,70,130,60,60,150,150,90,170,220,160,150,60,50,60)


tiempo=c(2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020)


plot(tiempo,afiliados,type = "o")

plot(tiempo,pbi_pc,type = "o")


#--------------------------------------------------------------------------

g=ggplot(data.frame(pbi_pc=pbi_pc,afiliados=afiliados),aes(x=pbi_pc,y=afiliados))
g=g+geom_smooth(method=lm,formula = y ~ poly(x, 1))
g=g+geom_point(shape=1)
g

#-------------------------------------------------------------------------
#Modelo lineal

modelo_lineal=lm(afiliados~pbi_pc)

summary(modelo_lineal)


#---------------------------------------------------------------------------
#Analisis supuestos
#---------------------------------------------------------------------------
#Test de shapiro-Wilks
#---------------------------------------------------------------------------

#H0: Es normal    vs    H1: no es normal

shapiro.test(rstandard(modelo_lineal))

hist(modelo_lineal$residuals)


#-----------------------------------------------------------------------------------
#test Breusch-Pagan test
#----------------------------------------------------------------------------------

#H0: todas las varianzas son iguales vs H1: al menos una es diferente

bptest(modelo_lineal)



#--------------------------------------------------------------------------------------
#Durbin-Watson
#--------------------------------------------------------------------------------------
#H0: errores son independientes  vs H1: no son independientes

dwtest(modelo_lineal)



#----------------------------------------------------------------------------------------

0.010965*11000


