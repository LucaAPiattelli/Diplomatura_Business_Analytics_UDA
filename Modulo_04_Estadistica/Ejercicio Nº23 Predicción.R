
#-----------------------------------------------------------------------------------------
#Cargar librerias
#----------------------------------------------------------------------------------------

library(forecast)


#-------------------------------------------------------------------------------------



datos=c(30,60,70,120,160,170,100, 230,200,160,180, 120, 80, 130,120,80,170, 110, 110,160,100, 80,
        90,50,110,100,80,100,70,120,100, 110,70, 80,100, 70, 130, 140,100, 110, 100,  140,140,140,
        120, 140,130,130,120, 110,120,130,120,110,120,110, 140, 160, 90, 60, 90, 90,100,130, 100,
        90, 90,90,80, 70, 60, 60, 90,120, 110,140,150, 150, 120,120,  130, 120,130, 150, 120,120,
        110,140,150,150, 120,120, 130,120, 130, 150,110,80,80,110,130,120, 140, 150,170,170,120,
        90, 80, 120,170,170,190,200,170, 140,110,140, 160,190,170,130,210,180,160, 210, 190, 190,
        150,200,200,210, 220, 280,170,200,240, 200, 200, 180, 210, 180, 180, 180, 160, 170, 170,
        150,150,170,180,170,220,260,200,190,150,130,120,110,70,80, 100,90,140,110, 110,110,60,70,
        90, 100,100,70,90,80,120, 60,70,70,50,50,80,60, 70,40,60,40, 50,50,60, 50, 60,  80)
 
  
#--------------------------------------------------------------------------------------
#Transformar los datos en ts

datos.ts = ts(datos, start = c(2005,1), frequency = 12)

datos.ts


plot(datos.ts, ylab="Afiliados", xlab="Tiempo" ,type="o",lwd=1,pch=1,cex=1,col="Green")

#-----------------------------------------------------------------------------------

datos.ts = log(datos.ts)
plot(datos.ts, ylab="Afiliados", xlab="Tiempo" ,type="o",lwd=1,pch=1,cex=1,col="Green")

#-----------------------------------------------------------------------------------
boxplot(datos.ts ~ cycle(datos.ts))

#-----------------------------------------------------------------------------------

datos.ts.desc = decompose(datos.ts)
plot(datos.ts.desc, xlab='Meses')

#----------------------------------------------------------------------------------
fit=auto.arima(datos.ts,seasonal = T,ic = c("aicc"), stepwise=T, allowdrift = T)
summary(fit)

#---------------------------------------------------------------------------------
plot(forecast(fit, h=12),ylab="Afiliados", xlab="Tiempo",type="o",lwd=1,pch=1,cex=1)
forecast(fit, h=12)

#--------------------------------------------------------------------...........
#invertir el log


predic.log=forecast(fit, h=12)

exp(predic.log$mean)
exp(predic.log$lower)
exp(predic.log$upper)
